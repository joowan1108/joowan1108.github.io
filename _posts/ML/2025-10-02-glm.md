---
layout: single
title: "Generalized Linear Models"
categories: ML
tag: [머신러닝]
author_profile: false
sidebar:
    nav: "counts"
toc: true
toc_sticky: true
toc_label: Table of Contents
use_math = True
---

# Generalized Linear Models (GLM)

$\mu$와 $\phi$가 각각 x와 $\phi$의 함수로 정의되었을 때, Linear regression에서 $p(y \mid x ; \theta) \sim N(\mu, \sigma^2)$을 따른다는 가정이나 Binary classification에서 $p(y \mid x ; \theta) \sim \text{Bernoulli}(\phi)$을 따른다는 가정 모두 임의로 결정한 것이 아니라 둘 다 GLM의 특별한 케이스에 해당되기 때문이다.  GLM을 알기 위해서는 **Exponential Family** 에 대한 사전 지식이 필요하다.

## Exponential Family
Exponential Family에 속하는 모든 분포는 다음 형태를 따른다.
$$
p(y \mid \eta) = b(y) exp (\eta^T T(y) - a(\eta))  = b(y) \cdot \frac {exp(\eta^T T(y))} {exp(a(\eta))}
$$
Distribution family를 결정하는 고정된 T,a,b가 존재하고 $\eta$ 값에 따라 그 family 안에서 특정 distribution이 결정된다. 

### Bernouli Distribution $\subset$ Exponential Family Distribution

$$
p(y ; \phi) = \phi^y \cdot (1 - \phi)^{1-y} = exp( log ( \phi^y \cdot (1 - \phi)^{1-y} ) )
$$

$$
 = exp(ylog\phi + (1-y)log(1-\phi))
$$

$$
= exp(log(\frac{\phi} {1 - \phi})y + log(1-\phi))
$$

이 식과 Exponential family 형태를 비교하면 b(y)=1, T(y) = y, a($\eta$) = - $log(1-\phi)$일 때 Exponential family distribution이 Bernoulli Distribution이 되는 것을 알 수 있다. 이때,  $\eta = log(\frac {\phi} {1-\phi})$이기 때문에 $\eta$ 값에 따라서 Bernoulli Distribution의 평균 $\phi$가 달라지는 것을 알 수 있다. 즉, $\eta$가 특정 Bernoulli distribution을 결정한다는 것을 알 수 있다.

### Gaussian Distribution $\subset$ Exponential Family Distribution

Gaussian density function은 다음과 같다.
$$
p(y  ; \mu) = \frac{1}{\sigma\sqrt{2\pi}} e^{-\frac{1}{2}\left(\frac{y-\mu}{\sigma}\right)^2}
$$

이때, 계산을 쉽게 하기 위해 $\sigma$ = 1이라고 가정하자. 다시 작성하면 

$$
p(y  ; \mu) = \frac{1}{\sqrt{2\pi}} e^{-\frac{1}{2}({y-\mu})^2}
$$

$$
= \frac{1}{\sqrt{2\pi}} e^{\frac {-1} {2} y^2} \cdot e^{\mu y - \frac{1} {2} \mu^2}
$$

이 식과 Exponential family 형태를 비교하면 b(y) = $\frac{1}{\sqrt{2\pi}} e^{\frac {-1} {2} y^2}$, T(y) = y, a($\eta$) = $\frac{1} {2} \mu^2$의 값을 가질 때, Exponential family distribution이 Gaussian Distribution이 되는 것을 알 수 있다. 이때, $\eta$ = $\mu$이기 때문에 a($\eta$) = $\frac{1} {2} \eta^2$이다. 즉, $\eta$ 값이 특정 Gaussian distribution을 결정한다는 것을 알 수 있다. 


## Generalized Linear Model이란 무엇인가
x에 대한 함수로 y를 예측하고 싶을 때, GLM으로 이 문제 해결법을 구할 수 있다. 이때 GLM을 적용하기 위해서는 $y \mid x$ 분포와 model에 대한 가정을 3가지 해야 한다.
+ $y \mid x ; \theta \sim$ Exponential Family ($\eta$)
**직관적 설명**: data y와 x의 특징에 따라 $y \mid x$가 따르는 Exponential Family 분포가 있다고 가정한다는 것이다.

+ Model의 목적은 $T(y)$의 기댓값을 예측하는 것이다. 즉, **가설 함수 (hypothesis)**는 $h_\theta$​(x)=E[T(y)∣x;θ] 로 정의된다. (대부분의 경우 T(y)=y이므로 $h_\theta(x) = E[y \mid x]$이다). 즉, hypothesis는 문제를 해결하기 위해 고른 distribution 종류에 따라 이미 정해져 있다. (distribution 종류마다 정해진 T(y)가 있으므로)
**직관적 설명**: 예측을 data가 따르는 Exponential family 분포의 기댓값으로 설정하여 $y \mid x$가 따른다고 가정한 분포를 $\theta$가 맞추도록 학습한다는 것이다. 이때 $\theta$를 학습하는 것은 distribution family의 특정 member를 결정하는 parameter $\eta$를 알아내는 것과 동일하다.

+ $\eta$는 $\theta$와 linear한 관계에 있다. 즉, $\eta$ = $\theta^T x$을 만족한다.
**직관적 설명**: Test time 에서 학습한 $\theta$을 통해 새로운 x들도 비숫한 분포를 따를 것이라고 가정하여 예측한다는 의미이다.

### GLM의 정의로 Linear Regression 유도
1. y가 continuous한 문제 상황에서 $y \mid x$가 Exponential Distribution Family에서 속하는 Gaussian $N(\mu, \sigma^2)$을 따른다고 가정

2. $y \mid x$ 는 Gaussian 분포를 따르므로 $h_\theta(x) = E[ T(y) \mid x ; \theta] = \mu$. 이때, 위에서 본 exponential family 분포의 특징에 따라 $\mu = \eta$

3. $\mu$ (T(y)의 기댓값) = $\eta$  = $\theta^T x$ (가정 3). 즉, hypothesis가 $\theta^T x$로 되는 것이다. $\theta$를 학습하여 hypothesis $\theta^T x$로 x가 주어졌을 때 T(y) = y의 기댓값을 잘 예측할 수 있도록 하는 것이다. 그래서 Linear Regression을 학습할 때 
$$
\max_{\theta} log L(\theta) = \max_{\theta} \sum_{i=1}^{n} log(\frac {1} {\sqrt{2\pi} \sigma} exp(-\frac {(y^{(i)}) - \theta^Tx^{(i)}} {2\sigma^2})^2) 
$$
이를 정리하면 결국
$$
\min​_{\theta} \sum_{i=1}^{n}​(y(i)−\theta^Tx(i))^2
$$
을 통해 T(y)의 기댓값 y와 $\theta^T x$가 비슷하도록 하는 것이다.

